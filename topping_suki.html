<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏™‡∏∏‡∏Å‡∏µ‡πâ/‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤</title> 
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ======================================= */
        /* === 1. BASE STYLES & TYPOGRAPHY === */
        /* ======================================= */
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f1e9d9;
            color: #333;
            margin: 0;
            padding: 10px;
            padding-bottom: 150px;
        } 
        .container {
            max-width: 960px;
            margin: auto;
            padding: 0;
        }
        h1 {
            color: #940109;
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        p.price-info {
            color: #940109;
            text-align: center;
            font-size: 1.0em;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        /* ======================================= */
        /* === 2. TOPPING STYLES === */
        /* ======================================= */
        .topping-category {
            margin-bottom: 25px;
            border-top: 3px solid #940109;
            padding-top: 15px;
        }
        .category-title {
            font-size: 1.3em;
            color: #940109;
            font-weight: 700;
            margin-bottom: 12px;
            padding-left: 5px;
        }
        .topping-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); 
            gap: 8px;
            padding: 0 5px;
        }
        .topping-card {
            background-color: #ffffff;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 8px 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 140px;
        }
        .topping-card:hover {
            border-color: #940109;
        }
        .topping-card.selected {
            border-color: #27ae60;
            box-shadow: 0 0 10px rgba(39, 174, 96, 0.3);
            background-color: #e8f5e9;
        }
        
        .topping-card img {
            width: 100%;
            max-width: 65px;
            height: 65px;
            object-fit: cover;
            border-radius: 6px;
            margin: 0 auto 5px auto;
        }
        .topping-name {
            font-size: 0.75em;
            font-weight: 700;
            color: #333;
            line-height: 1.1;
            min-height: 2.2em; 
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 2px;
        }
        .topping-note {
            font-size: 0.65em; 
            color: #555; 
            line-height: 1;
            margin-bottom: 3px;
        }
        .topping-price {
            font-size: 0.9em;
            color: #940109;
            font-weight: 700;
        }
        
        /* New Badge Style */
        .badge-new {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #ff0000;
            color: white;
            font-size: 0.6em;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 5px;
            text-transform: uppercase;
            z-index: 10;
        }

        .count-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;
            visibility: hidden; 
            opacity: 0;
            transition: all 0.2s;
        }
        .topping-card.selected .count-controls {
            visibility: visible;
            opacity: 1;
        }
        .count-controls button {
            background-color: #940109;
            color: white;
            border: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 1.0em;
            line-height: 1;
            cursor: pointer;
            padding: 0;
            margin: 0 2px;
        }
        .count-controls .count-display {
            font-size: 0.9em;
            font-weight: 700;
            width: 20px;
            text-align: center;
            color: #940109;
        }

        /* ======================================= */
        /* === 3. FIXED FOOTER === */
        /* ======================================= */
        .footer-fixed {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: transparent;
            padding: 15px 0;
            pointer-events: none;
            z-index: 1000;
        }
        .footer-content {
            max-width: 960px;
            margin: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 15px;
            pointer-events: none;
        }

        .next-btn {
            background-color: #940109; 
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            font-size: 1.0em;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            pointer-events: auto;
            display: flex;
            align-items: center;
            gap: 8px;
            width: 90%;
            justify-content: center;
        }
        
        .next-btn.disabled {
            background-color: #ccc;
        }

        .total-amount {
            background-color: #ffffff;
            color: #940109;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 700;
            margin-left: 5px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏áüß∫</h1>
        <p class="price-info" id="main-item-info"></p>

        <div id="topping-sections"></div>
    </div>

    <div class="footer-fixed">
        <div class="footer-content">
            <button class="next-btn" id="next-btn" onclick="calculateAndSave()">
                ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ 
                <span class="total-amount" id="grand-total-display">0 ‡∏ö‡∏≤‡∏ó</span>
            </button>
        </div>
    </div>

<script>
    // ========================================================
    // === 1. TOPPING DATA ===
    // ========================================================
    const TOPPING_DATA = [
        { id: 'T0.0', category: '‡∏´‡∏°‡∏ß‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡∏ä‡∏µ‡∏™‡∏≠‡∏≤‡∏ö', image: 'cheeses.png', price: 20 },

        { id: 'T0', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏´‡∏°‡∏π‡∏´‡∏°‡∏±‡∏Å‡∏ô‡∏∏‡πà‡∏°', image: 'moomuk-noom.png', price: 10 },
        { id: 'T1', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏´‡∏°‡∏π‡∏ö‡∏∞‡∏ä‡πà‡∏≠', image: 'bacho.png', price: 10 },
        { id: 'T2', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πâ', image: 'moo3mai.png', price: 10 },
        { id: 'T3', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏±‡∏ô‡∏Ñ‡∏≠‡∏™‡πÑ‡∏•‡∏ã‡πå', image: 'sunko.png', price: 10 },
        { id: 'T4', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏™‡πÑ‡∏•‡∏ã‡πå', image: '3chun.png', price: 10 },
        { id: 'T5', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏´‡∏°‡∏π‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πâ', image: 'moomai.png', price: 10 },
        { id: 'T6', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏û‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏î‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏≠‡∏á', image: '3chunpunhed.png', price: 10 },
        { id: 'T6.5', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏û‡∏±‡∏ô‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô', image: 'beconpun.png', price: 10 },

        { id: 'T7', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤', image: 'rooppla.png', price: 10 },
        { id: 'T8', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏µ‡∏™‡∏¢‡∏≤‡∏ß', image: 'cheeseyaww.png', price: 10 },
        { id: 'T9', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏ô‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏ä‡∏µ‡∏™', image: 'nunggroobchhet.png', price: 10 },
        { id: 'T10', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏°‡∏¥‡∏ô‡∏¥‡∏Ñ‡∏≠‡∏Å‡πÄ‡∏ó‡∏•', image: 'mini.png', price: 10 },
        { id: 'T11', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏õ‡∏π‡∏≠‡∏±‡∏î‡∏ä‡∏µ‡∏™', image: 'poocheese.png', price: 10 },
        { id: 'T12', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏õ‡∏≤‡πÑ‡∏Ç‡πà‡∏Å‡∏∏‡πâ‡∏á', image: 'paokaigung.png', price: 10 },
        { id: 'T13', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏õ‡∏•‡∏≤‡∏î‡∏≠‡∏•‡∏•‡∏µ‡πà', image: 'dolly.png', price: 10 },
        { id: 'T14', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏ä‡∏µ‡∏™', image: 'paochese.png', price: 10 },
        { id: 'T15', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î', image: 'fongZ-fod.png', price: 10 },
        { id: 'T16', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÅ‡∏°‡∏á‡∏Å‡∏∞‡∏û‡∏£‡∏∏‡∏ô', image: 'manggapun.png', price: 10 },
        { id: 'T17', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏≠‡∏≠‡∏°‡∏∏‡∏Å', image: 'plapan.png', price: 10 },
        { id: 'T18', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏´‡∏°‡∏∂‡∏Å‡∏Å‡∏£‡∏≠‡∏ö', image: 'meukgrop.png', price: 10 },
        { id: 'T19', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏™‡πÑ‡∏ö‡∏ô‡∏≤‡∏á', image: 'zbainag.png', price: 10 },

        { id: 'T20', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÑ‡∏Ç‡πà', image: 'taohooegg.png', price: 10 },
        { id: 'T21', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏°‡πâ‡∏ß‡∏ô', image: 'fongmauon.png', price: 10 },
        { id: 'T22', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÄ‡∏•‡πá‡∏Å', image: 'zenfonglek.png', price: 10 },
        { id: 'T23', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà', image: 'Zenfongyai.png', price: 10 },
        { id: 'T24', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏™‡∏≤‡∏´‡∏£‡πà‡∏≤‡∏¢', image: 'fongsarai.png', price: 10 },
        { id: 'T25', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏î‡∏π‡∏î‡∏ã‡∏∏‡∏õ', image: 'fongdoodsup.png', price: 10 },

        { id: 'T26', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏à‡∏µ‡∏ô', image: 'zenlek.png', price: 10 }, 
        { id: 'T27', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏±‡∏ô‡∏°‡πà‡∏ß‡∏á', image: 'zenmunmung.png', price: 10 },
        { id: 'T28', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡∏ö', image: 'zenmunneub.png', price: 10 },
        { id: 'T28.1', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡∏ö', image: 'zenlek-mun.png', price: 10, isNew: true },
        { id: 'T29', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà‡∏ú‡∏±‡∏Å', image: 'bamheepuk.png', price: 10 },
        { id: 'T30', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', image: 'kaopod.png', price: 10 },
        { id: 'T31', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î', image: 'pukgad.png', price: 10 },
        { id: 'T32', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ß‡∏≤‡∏Å‡∏≤‡πÄ‡∏°‡∏∞', image: 'wakame.png', price: 10 },
        { id: 'T33', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ö‡∏∏‡∏Å‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤', image: 'zenbuk.png', price: 10 },
        { id: 'T34', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏ö‡∏ö‡∏µ‡πâ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á', image: 'babygwangtung.png', price: 10 },
        { id: 'T35', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ß‡∏∏‡πâ‡∏ô‡πÄ‡∏™‡πâ‡∏ô', image: 'woonzen.png', price: 10 },
        { id: 'T36', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏´‡πá‡∏î‡∏≠‡∏≠‡∏£‡∏¥‡∏ô‡∏à‡∏¥', image: 'hedaurinji.png', price: 10 },
        { id: 'T37', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ä‡∏∏‡∏î‡∏ú‡∏±‡∏Å', image: 'chodpuk.png', price: 10 },

        { id: 'T38', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡∏ï‡πä‡∏≠‡∏Å‡∏ö‡∏Å‡∏Å‡∏µ‡πÑ‡∏™‡πâ‡∏ä‡∏µ‡∏™', image: 'tokcheese.png', price: 10 },
        { id: 'T39', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡πÑ‡∏Ç‡πà‡∏ô‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏≤', image: 'nokgataegg.png', price: 10 },
        { id: 'T40', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡πÑ‡∏Ç‡πà‡πÑ‡∏Å‡πà', image: 'egg.png', price: 10 },

        { id: 'T41', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏°‡πâ‡∏ß‡∏ô ‡πÅ‡∏û‡πá‡∏Ñ‡∏•‡∏∞ 59 ‡∏ö‡∏≤‡∏ó', image: 'fong-pack.png', price: 59, note: '‡πÅ‡∏ö‡∏ö‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ' },
        { id: 'T42', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡πÅ‡∏î‡∏á', image: 'zenred-pack.png', price: 29 },
        { id: 'T43', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å', image: 'zen-p.png', price: 29 }, 
        { id: 'T44', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏õ‡∏ß‡∏¢‡πÄ‡∏•‡πâ‡∏á', image: 'zen-u.png', price: 29 },
        { id: 'T45', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏°‡∏±‡∏ô‡∏°‡πà‡∏ß‡∏á', image: 'zen-m.png', price: 29 },
        { id: 'T46', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á', image: 'zen-f.png', price: 29 },
        { id: 'T47', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö‡πÄ‡∏•‡πá‡∏Å', image: 'zen-l.png', price: 29 },
        { id: 'T48', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ã‡∏±‡∏ô‡πÄ‡∏¢‡∏≤', image: 'zunyao.png', price: 29 },

        { id: 'T49', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏™‡∏∏‡∏Å‡∏µ‡πâ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á', image: 'N-suki.png', price: 12 },
        { id: 'T50', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏á‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤', image: 'N-mala.png', price: 29 },
        { id: 'T51', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏á‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡∏´‡∏≠‡∏°', image: 'N-vha.png', price: 25 },
        { id: 'T52', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 220 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏á‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤‡πÅ‡∏ö‡∏ö‡∏Ç‡∏ß‡∏î', image: 'mala_sauce.png', price: 69 },
    ];
    
    let selectedToppings = {}; 
    let mainItemDetails = {}; 
    let grandTotal = 0; 
    const MIN_TOPPINGS_COUNT = 3; 

    function loadSukiDetails() {
        const storedDetails = sessionStorage.getItem('sukiMainItem');
        if (storedDetails) {
            mainItemDetails = JSON.parse(storedDetails);
            const infoElement = document.getElementById('main-item-info');
            infoElement.innerHTML = `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å: 
                <strong>${mainItemDetails.name}</strong> 
                (${mainItemDetails.price.toLocaleString()} ‡∏ö‡∏≤‡∏ó)
                ${mainItemDetails.spice ? ` - ‡πÄ‡∏ú‡πá‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${mainItemDetails.spice}` : ''}
            `;
        } else {
             document.getElementById('main-item-info').innerText = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
             setTimeout(() => { window.location.href = 'suki_type.html'; }, 1000);
        }
    }

    function renderToppings() {
        const container = document.getElementById('topping-sections');
        if (!container) return;

        const groupedToppings = TOPPING_DATA.reduce((acc, item) => {
            acc[item.category] = acc[item.category] || [];
            acc[item.category].push(item);
            return acc;
        }, {});

        let html = '';
        for (const category in groupedToppings) {
            html += `<div class="topping-category">`;
            html += `<h2 class="category-title">${category}</h2>`;
            html += `<div class="topping-grid">`;

            groupedToppings[category].forEach(item => {
                html += `
                    <div class="topping-card" 
                        data-id="${item.id}"
                        onclick="updateToppingSelection('${item.id}')"
                        id="card-${item.id}"
                    >
                        ${item.isNew ? `<span class="badge-new">New</span>` : ''}
                        <img src="images/${item.image}" alt="${item.name}">
                        <div class="topping-name">${item.name}</div>
                        ${item.note ? `<div class="topping-note">${item.note}</div>` : ''}
                        <div class="topping-price">${item.price.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
                        
                        <div class="count-controls">
                            <button onclick="changeCount(event, '${item.id}', -1)">-</button>
                            <span class="count-display" id="count-${item.id}">1</span>
                            <button onclick="changeCount(event, '${item.id}', 1)">+</button>
                        </div>
                    </div>
                `;
            });
            html += `</div></div>`;
        }
        container.innerHTML = html;
        updateTotalDisplay();
    }

    function updateToppingSelection(id) {
        const itemData = TOPPING_DATA.find(item => item.id === id);
        const cardElement = document.getElementById(`card-${id}`);

        if (!itemData || !cardElement) return;

        if (selectedToppings[id]) {
            delete selectedToppings[id];
            cardElement.classList.remove('selected');
        } else {
            selectedToppings[id] = { ...itemData, count: 1 };
            cardElement.classList.add('selected');
            const countDisplay = document.getElementById(`count-${id}`);
            if (countDisplay) countDisplay.innerText = 1;
        }
        updateTotalDisplay();
    }

    function changeCount(event, id, delta) {
        event.stopPropagation();
        if (!selectedToppings[id]) return;

        let newCount = selectedToppings[id].count + delta;
        if (newCount <= 0) {
            updateToppingSelection(id);
        } else {
            selectedToppings[id].count = newCount;
            document.getElementById(`count-${id}`).innerText = newCount;
            updateTotalDisplay();
        }
    }

    function updateTotalDisplay() {
        let toppingTotal = Object.values(selectedToppings).reduce((total, item) => total + (item.price * item.count), 0);
        let totalToppingCount = Object.values(selectedToppings).reduce((count, item) => count + item.count, 0);

        const mainPrice = mainItemDetails.price || 0;
        grandTotal = mainPrice + toppingTotal;

        const totalDisplayElement = document.getElementById('grand-total-display');
        const nextButton = document.getElementById('next-btn');

        if (totalDisplayElement) totalDisplayElement.innerText = `${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
        
        if (totalToppingCount < MIN_TOPPINGS_COUNT) {
            nextButton.classList.add('disabled');
            nextButton.innerHTML = `üìå ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å ${MIN_TOPPINGS_COUNT - totalToppingCount} ‡πÑ‡∏°‡πâ <span class="total-amount">${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>`;
        } else {
            nextButton.classList.remove('disabled');
            nextButton.innerHTML = `‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ <span class="total-amount">${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>`;
        }
    }

    function calculateAndSave() {
        let totalToppingCount = Object.values(selectedToppings).reduce((count, item) => count + item.count, 0);
        if (totalToppingCount < MIN_TOPPINGS_COUNT) {
            alert(`‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${MIN_TOPPINGS_COUNT} ‡πÑ‡∏°‡πâ`);
            return;
        }

        let orderItems = [];
        orderItems.push({ id: 'M1', name: mainItemDetails.name, price: mainItemDetails.price, count: 1, type: 'Main' });
        if (mainItemDetails.spice) {
             orderItems.push({ id: 'S1', name: `‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏ú‡πá‡∏î: ${mainItemDetails.spice}`, price: 0, count: 1, type: 'Spice' });
        }

        Object.values(selectedToppings).forEach(topping => {
            orderItems.push({
                id: topping.id,
                name: topping.name + (topping.note ? ` (${topping.note})` : ''),
                price: topping.price,
                count: topping.count,
                type: 'Topping'
            });
        });

        const finalOrderSet = {
            name: mainItemDetails.name + (totalToppingCount > 0 ? ` (+${totalToppingCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)` : ''), 
            price: grandTotal,
            count: 1, 
            details: orderItems,
            isSukiSet: true
        };

        let cartItems = JSON.parse(sessionStorage.getItem('cartItems') || '[]');
        cartItems.push(finalOrderSet);
        sessionStorage.setItem('cartItems', JSON.stringify(cartItems));
        sessionStorage.removeItem('sukiMainItem');

        window.location.href = 'summary.html';
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadSukiDetails();
        renderToppings();
    });
</script>
</body>
</html>
