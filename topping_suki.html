<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏™‡∏∏‡∏Å‡∏µ‡πâ/‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤</title> 
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ======================================= */
        /* === 1. BASE STYLES & TYPOGRAPHY === */
        /* ======================================= */
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f1e9d9;
            color: #333;
            margin: 0;
            padding: 15px;
            padding-bottom: 150px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Footer */
        }
        .container {
            max-width: 960px;
            margin: auto;
            padding: 0 5px;
        }
        h1 {
            color: #940109;
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        p.price-info {
            color: #940109;
            text-align: center;
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        /* ======================================= */
        /* === 2. TOPPING STYLES === */
        /* ======================================= */
        .topping-category {
            margin-bottom: 30px;
            border-top: 3px solid #940109;
            padding-top: 15px;
        }
        .category-title {
            font-size: 1.6em;
            color: #940109;
            font-weight: 700;
            margin-bottom: 15px;
            padding-left: 10px;
        }
        .topping-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 15px;
            padding: 0 10px;
        }
        .topping-card {
            background-color: #ffffff;
            border: 3px solid #ccc;
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        .topping-card:hover {
            border-color: #940109;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .topping-card.selected {
            border-color: #27ae60; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß */
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.5);
            background-color: #e8f5e9;
        }
        
        .topping-card img {
            width: 80px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û */
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        .topping-name {
            font-size: 0.9em;
            font-weight: 700;
            color: #333;
            line-height: 1.2;
            min-height: 30px; 
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 3px;
        }
        .topping-note {
            font-size: 0.8em; 
            color: #555; 
            line-height: 1;
            margin-bottom: 3px;
        }
        .topping-price {
            font-size: 1.0em;
            color: #940109;
            font-weight: 700;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô */
        .count-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;
            visibility: hidden; 
            opacity: 0;
            transition: all 0.2s;
        }
        .topping-card.selected .count-controls {
            visibility: visible;
            opacity: 1;
        }
        .count-controls button {
            background-color: #940109;
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            font-size: 1.2em;
            line-height: 1;
            cursor: pointer;
            padding: 0;
            margin: 0 5px;
        }
        .count-controls .count-display {
            font-size: 1.1em;
            font-weight: 700;
            width: 30px;
            text-align: center;
            color: #940109;
        }

        /* ======================================= */
        /* === 3. FIXED FOOTER (MODIFIED FOR TOTAL) === */
        /* ======================================= */
        .footer-fixed {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: transparent;
            border-top: none;
            padding: 10px 0;
            box-shadow: none;
            pointer-events: none;
        }
        .footer-content {
            max-width: 960px;
            margin: auto;
            display: flex;
            justify-content: flex-end; 
            align-items: center;
            padding: 0 15px;
            pointer-events: none;
        }

        .next-btn {
            background-color: #940109; 
            color: #ffffff;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            pointer-events: auto;
            
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ */
        .next-btn.disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .next-btn.disabled .total-amount {
             background-color: #f0f0f0;
        }

        .total-amount {
            background-color: #ffffff;
            color: #940109;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 700;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°</h1>
        <p class="price-info" id="main-item-info">
            </p>

        <div id="topping-sections">
            </div>

    </div>

    <div class="footer-fixed">
        <div class="footer-content">
            <button class="next-btn" id="next-btn" onclick="calculateAndSave()">
                ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ 
                <span class="total-amount" id="grand-total-display">0 ‡∏ö‡∏≤‡∏ó</span>
            </button>
        </div>
    </div>

<script>
    // ========================================================
    // === 1. TOPPING DATA (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î) ===
    // ========================================================
    const TOPPING_DATA = [
        // --- # ü•© ‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π - 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        { id: 'T1', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏´‡∏°‡∏π‡∏ö‡∏∞‡∏ä‡πà‡∏≠', image: 'bacho.png', price: 10 },
        { id: 'T2', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πâ', image: 'moo3mai.png', price: 10 },
        { id: 'T3', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏±‡∏ô‡∏Ñ‡∏≠‡∏™‡πÑ‡∏•‡∏ã‡πå', image: 'sunko.png', price: 10 },
        { id: 'T4', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏™‡πÑ‡∏•‡∏ã‡πå', image: '3chun.png', price: 10 },
        { id: 'T5', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏´‡∏°‡∏π‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πâ', image: 'moomai.png', price: 10 },
        { id: 'T6', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏û‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏î‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏≠‡∏á', image: '3chunpunhed.png', price: 10 },
        { id: 'T6.5', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏π', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏û‡∏±‡∏ô‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô', image: 'beconpun.png', price: 10 },

        // --- # üç¢ ‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏• - 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        { id: 'T7', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏£‡∏π‡∏õ‡∏õ‡∏•‡∏≤', image: 'rooppla.png', price: 10 },
        { id: 'T8', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏µ‡∏™‡∏¢‡∏≤‡∏ß', image: 'cheeseyaww.png', price: 10 },
        { id: 'T9', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏ô‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏ä‡∏µ‡∏™', image: 'nunggroobchhet.png', price: 10 },
        { id: 'T10', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏°‡∏¥‡∏ô‡∏¥‡∏Ñ‡∏≠‡∏Å‡πÄ‡∏ó‡∏•', image: 'mini.png', price: 10 },
        { id: 'T11', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏õ‡∏π‡∏≠‡∏±‡∏î‡∏ä‡∏µ‡∏™', image: 'poocheese.png', price: 10 },
        { id: 'T12', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏õ‡∏≤‡πÑ‡∏Ç‡πà‡∏Å‡∏∏‡πâ‡∏á', image: 'paokaigung.png', price: 10 },
        { id: 'T13', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏õ‡∏•‡∏≤‡∏î‡∏≠‡∏•‡∏•‡∏µ‡πà', image: 'dolly.png', price: 10 },
        { id: 'T14', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏ä‡∏µ‡∏™', image: 'paochese.png', price: 10 },
        { id: 'T15', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î', image: 'fongZ-fod.png', price: 10 },
        { id: 'T16', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡πÅ‡∏°‡∏á‡∏Å‡∏∞‡∏û‡∏£‡∏∏‡∏ô', image: 'manggapun.png', price: 10 },
        { id: 'T17', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏≠‡∏≠‡∏°‡∏∏‡∏Å', image: 'plapan.png', price: 10 },
        { id: 'T18', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏´‡∏°‡∏∂‡∏Å‡∏Å‡∏£‡∏≠‡∏ö', image: 'meukgrop.png', price: 10 },
        { id: 'T19', category: '‡∏´‡∏°‡∏ß‡∏î‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô ‚Äì ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‚Äì ‡∏ó‡∏∞‡πÄ‡∏•', name: '‡∏™‡πÑ‡∏ö‡∏ô‡∏≤‡∏á', image: 'zbainag.png', price: 10 },

        // --- # üßÄ ‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ - 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        { id: 'T20', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÑ‡∏Ç‡πà', image: 'taohooegg.png', price: 10 },
        { id: 'T21', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏°‡πâ‡∏ß‡∏ô', image: 'fongmauon.png', price: 10 },
        { id: 'T22', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÄ‡∏•‡πá‡∏Å', image: 'zenfonglek.png', price: 10 },
        { id: 'T23', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà', image: 'Zenfongyai.png', price: 10 },
        { id: 'T24', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏™‡∏≤‡∏´‡∏£‡πà‡∏≤‡∏¢', image: 'fongsarai.png', price: 10 },
        { id: 'T25', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏î‡∏π‡∏î‡∏ã‡∏∏‡∏õ', image: 'fongdoodsup.png', price: 10 },

        // --- # ü•¨ ‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô - 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        { id: 'T26', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏à‡∏µ‡∏ô', image: 'zenlek.png', price: 10 }, 
        { id: 'T27', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏±‡∏ô‡∏°‡πà‡∏ß‡∏á', image: 'zenmunmung.png', price: 10 },
        { id: 'T28', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡∏ö', image: 'zenmunneub.png', price: 10 },
        { id: 'T29', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà‡∏ú‡∏±‡∏Å', image: 'bamheepuk.png', price: 10 },
        { id: 'T30', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', image: 'kaopod.png', price: 10 },
        { id: 'T31', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î', image: 'pukgad.png', price: 10 },
        { id: 'T32', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ß‡∏≤‡∏Å‡∏≤‡πÄ‡∏°‡∏∞', image: 'wakame.png', price: 10 },
        { id: 'T33', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏ö‡∏∏‡∏Å‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤', image: 'zenbuk.png', price: 10 },
        { id: 'T34', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏ö‡∏ö‡∏µ‡πâ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á', image: 'babygwangtung.png', price: 10 },
        { id: 'T35', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ß‡∏∏‡πâ‡∏ô‡πÄ‡∏™‡πâ‡∏ô', image: 'woonzen.png', price: 10 },
        { id: 'T36', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡πÄ‡∏´‡πá‡∏î‡∏≠‡∏≠‡∏£‡∏¥‡∏ô‡∏à‡∏¥', image: 'hedaurinji.png', price: 10 },
        { id: 'T37', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ú‡∏±‡∏Å ‚Äì ‡πÄ‡∏™‡πâ‡∏ô', name: '‡∏ä‡∏∏‡∏î‡∏ú‡∏±‡∏Å', image: 'chodpuk.png', price: 10 },

        // --- # üç≥ ‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© - 10 ‡∏ö‡∏≤‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        { id: 'T38', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡∏ï‡πä‡∏≠‡∏Å‡∏ö‡∏Å‡∏Å‡∏µ‡πÑ‡∏™‡πâ‡∏ä‡∏µ‡∏™', image: 'tokcheese.png', price: 10 },
        { id: 'T39', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡πÑ‡∏Ç‡πà‡∏ô‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏≤', image: 'nokgataegg.png', price: 10 },
        { id: 'T40', category: '‡∏´‡∏°‡∏ß‡∏î‡πÑ‡∏Ç‡πà ‚Äì ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©', name: '‡πÑ‡∏Ç‡πà‡πÑ‡∏Å‡πà', image: 'egg.png', price: 10 },

        // --- # üì¶ ‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ - ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ---
        { id: 'T41', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡∏ü‡∏≠‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏°‡πâ‡∏ß‡∏ô ‡πÅ‡∏û‡πá‡∏Ñ‡∏•‡∏∞ 59 ‡∏ö‡∏≤‡∏ó', image: 'fong-pack.png', price: 59, note: '‡πÅ‡∏ö‡∏ö‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ' },
        { id: 'T42', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡πÅ‡∏î‡∏á', image: 'zenred-pack.png', price: 29 },
        { id: 'T43', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å', image: 'zen-p.png', price: 29 }, 
        { id: 'T44', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏õ‡∏ß‡∏¢‡πÄ‡∏•‡πâ‡∏á', image: 'zen-u.png', price: 29 },
        { id: 'T45', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏°‡∏±‡∏ô‡∏°‡πà‡∏ß‡∏á', image: 'zen-m.png', price: 29 },
        { id: 'T46', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö ‚Äì ‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á', image: 'zen-f.png', price: 29 },
        { id: 'T47', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡∏ö‡πÄ‡∏•‡πá‡∏Å', image: 'zen-l.png', price: 29 },
        { id: 'T48', category: '‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äì ‡∏¢‡∏Å‡πÅ‡∏û‡πá‡∏Ñ', name: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ã‡∏±‡∏ô‡πÄ‡∏¢‡∏≤', image: 'zunyao.png', price: 29 },

        // --- # ü•£ ‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml - ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ---
        { id: 'T49', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏™‡∏∏‡∏Å‡∏µ‡πâ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á', image: 'N-suki.png', price: 12 },
        { id: 'T50', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏á‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤', image: 'N-mala.png', price: 29 },
        { id: 'T51', category: '‡∏´‡∏°‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏° 100 ml', name: '‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏á‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡∏´‡∏≠‡∏°', image: 'N-vha.png', price: 25 },
    ];
    
    let selectedToppings = {}; 
    let mainItemDetails = {}; 
    let grandTotal = 0; 

    // ========================================================
    // === 2. CORE LOGIC FUNCTIONS ===
    // ========================================================
    
    // **‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å**
    const MIN_TOPPINGS_COUNT = 3; 

    /**
     * ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å (‡∏ô‡πâ‡∏≥‡∏ã‡∏∏‡∏õ/‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤) ‡∏à‡∏≤‡∏Å **Session Storage**
     */
    function loadSukiDetails() {
        const storedDetails = sessionStorage.getItem('sukiMainItem'); // **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà**
        if (storedDetails) {
            mainItemDetails = JSON.parse(storedDetails);
            const infoElement = document.getElementById('main-item-info');
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤
            infoElement.innerHTML = `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å: 
                <strong>${mainItemDetails.name}</strong> 
                (${mainItemDetails.price.toLocaleString()} ‡∏ö‡∏≤‡∏ó)
                ${mainItemDetails.spice ? ` - ‡πÄ‡∏ú‡πá‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${mainItemDetails.spice}` : ''}
            `;
             // **‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥**
             if (MIN_TOPPINGS_COUNT > 0) {
                 infoElement.innerHTML += `<br>üî• **‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${MIN_TOPPINGS_COUNT} ‡πÑ‡∏°‡πâ** üî•`;
             }
        } else {
             // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏∏‡∏Å‡∏µ‡πâ/‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤
             document.getElementById('main-item-info').innerText = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
             setTimeout(() => {
                 window.location.href = 'suki_type.html';
             }, 1000);
        }
    }

    /**
     * ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å TOPPING_DATA
     */
    function renderToppings() {
        const container = document.getElementById('topping-sections');
        if (!container) return;

        // 1. ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ï‡∏≤‡∏° Category
        const groupedToppings = TOPPING_DATA.reduce((acc, item) => {
            acc[item.category] = acc[item.category] || [];
            acc[item.category].push(item);
            return acc;
        }, {});

        let html = '';
        
        // 2. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ Category
        for (const category in groupedToppings) {
            html += `<div class="topping-category">`;
            html += `<h2 class="category-title">${category}</h2>`;
            html += `<div class="topping-grid">`;

            // 3. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á Card ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ Topping
            groupedToppings[category].forEach(item => {
                const priceDisplay = item.price.toLocaleString();
                html += `
                    <div class="topping-card" 
                        data-id="${item.id}"
                        data-name="${item.name}"
                        data-price="${item.price}"
                        onclick="updateToppingSelection('${item.id}')"
                        id="card-${item.id}"
                    >
                        <img src="images/${item.image}" alt="${item.name}">
                        <div class="topping-name">${item.name}</div>
                        ${item.note ? `<div class="topping-note">${item.note}</div>` : ''}
                        <div class="topping-price">${priceDisplay} ‡∏ö‡∏≤‡∏ó</div>
                        
                        <div class="count-controls">
                            <button onclick="changeCount(event, '${item.id}', -1)">-</button>
                            <span class="count-display" id="count-${item.id}">1</span>
                            <button onclick="changeCount(event, '${item.id}', 1)">+</button>
                        </div>
                    </div>
                `;
            });
            html += `</div>`; // .topping-grid
            html += `</div>`; // .topping-category
        }

        container.innerHTML = html;
        updateTotalDisplay();
    }

    /**
     * ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á
     * @param {string} id - ID ‡∏Ç‡∏≠‡∏á‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á
     */
    function updateToppingSelection(id) {
        // ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Data
        const itemData = TOPPING_DATA.find(item => item.id === id);
        const cardElement = document.getElementById(`card-${id}`);

        if (!itemData || !cardElement) return;

        if (selectedToppings[id]) {
            // üí° ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß: ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
            delete selectedToppings[id];
            cardElement.classList.remove('selected');
        } else {
            // üí° ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
            selectedToppings[id] = { 
                ...itemData, 
                count: 1 // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1
            };
            cardElement.classList.add('selected');
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1 (‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)
            const countDisplay = document.getElementById(`count-${id}`);
            if (countDisplay) countDisplay.innerText = 1;
        }

        updateTotalDisplay();
    }

    /**
     * ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
     * @param {Event} event - Event object (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á onclick ‡∏´‡∏•‡∏±‡∏Å)
     * @param {string} id - ID ‡∏Ç‡∏≠‡∏á‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á
     * @param {number} delta - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (+1 ‡∏´‡∏£‡∏∑‡∏≠ -1)
     */
    function changeCount(event, id, delta) {
        event.stopPropagation(); // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á onclick ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á Card

        if (!selectedToppings[id]) return;

        let newCount = selectedToppings[id].count + delta;
        
        if (newCount <= 0) {
            // ‡∏ñ‡πâ‡∏≤‡∏•‡∏î‡∏à‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 0 ‡πÉ‡∏´‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ô‡∏µ‡πâ
            updateToppingSelection(id);
        } else {
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            selectedToppings[id].count = newCount;
            document.getElementById(`count-${id}`).innerText = newCount;
            updateTotalDisplay();
        }
    }

    /**
     * ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å + ‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á) ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢
     */
    function updateTotalDisplay() {
        let toppingTotal = Object.values(selectedToppings).reduce((total, item) => {
            return total + (item.price * item.count);
        }, 0);

        // 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏°‡πâ)
        let totalToppingCount = Object.values(selectedToppings).reduce((count, item) => {
            return count + item.count;
        }, 0);

        // 2. ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å
        const mainPrice = mainItemDetails.price || 0;
        grandTotal = mainPrice + toppingTotal;

        // 3. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢
        const totalDisplayElement = document.getElementById('grand-total-display');
        const nextButton = document.getElementById('next-btn');

        if (totalDisplayElement) {
            totalDisplayElement.innerText = `${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
        }
        
        // 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
        if (totalToppingCount < MIN_TOPPINGS_COUNT) {
            nextButton.classList.add('disabled');
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥
            nextButton.innerHTML = `
                üìå ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å ${MIN_TOPPINGS_COUNT - totalToppingCount} ‡πÑ‡∏°‡πâ
                <span class="total-amount" id="grand-total-display">${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
            `;
            
        } else {
            nextButton.classList.remove('disabled');
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
            nextButton.innerHTML = `
                ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ 
                <span class="total-amount" id="grand-total-display">${grandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
            `;
        }

    }

    /**
     * ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ
     */
    function calculateAndSave() {
        // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å
        if (!mainItemDetails || !mainItemDetails.name || mainItemDetails.price === undefined) {
            alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            window.location.href = 'suki_type.html';
            return;
        }

        // 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (New Validation)
        let totalToppingCount = Object.values(selectedToppings).reduce((count, item) => {
            return count + item.count;
        }, 0);
        
        if (totalToppingCount < MIN_TOPPINGS_COUNT) {
            alert(`‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${MIN_TOPPINGS_COUNT} ‡πÑ‡∏°‡πâ (‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ${totalToppingCount} ‡πÑ‡∏°‡πâ)`);
            return;
        }
        
        // 3. ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°)
        let orderItems = [];
        let currentGrandTotal = mainItemDetails.price || 0; 

        // A. ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (‡∏ô‡πâ‡∏≥‡∏ã‡∏∏‡∏õ/‡∏´‡∏°‡πà‡∏≤‡∏•‡πà‡∏≤)
        const mainItemForOrder = {
            id: 'M1',
            name: mainItemDetails.name,
            price: mainItemDetails.price,
            count: 1,
            type: 'Main'
        };
        orderItems.push(mainItemForOrder);
        
        // B. ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ú‡πá‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        if (mainItemDetails.spice) {
             orderItems.push({
                 id: 'S1',
                 name: `‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏ú‡πá‡∏î: ${mainItemDetails.spice}`,
                 price: 0,
                 count: 1,
                 type: 'Spice'
             });
        }

        // C. ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á
        Object.values(selectedToppings).forEach(topping => {
            let toppingName = topping.name;
            if (topping.note) {
                 toppingName += ` (${topping.note})`;  
            }

            orderItems.push({
                id: topping.id,
                name: toppingName,
                price: topping.price,
                count: topping.count,
                type: 'Topping'
            });
            currentGrandTotal += topping.price * topping.count;
        });

        // 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Object ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Order Set)
        const finalOrderSet = {
            name: mainItemForOrder.name + (totalToppingCount > 0 ? ` (+${totalToppingCount} ‡πÑ‡∏°‡πâ)` : ''), 
            price: currentGrandTotal,
            count: 1, 
            details: orderItems,
            isSukiSet: true,
            isNoodleSet: false
        };

        // 5. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ (**Session Storage**)
        let cartItems = JSON.parse(sessionStorage.getItem('cartItems') || '[]'); // **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà**
        cartItems.push(finalOrderSet);
        sessionStorage.setItem('cartItems', JSON.stringify(cartItems)); // **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà**

        // 6. ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (**Session Storage**)
        sessionStorage.removeItem('sukiMainItem'); // **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà**

        // 7. ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ
        alert(`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß! ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ: ${currentGrandTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó`);
        window.location.href = 'summary.html';
    }

    // ========================================================
    // === 3. INITIALIZATION ===
    // ========================================================
    document.addEventListener('DOMContentLoaded', () => {
        loadSukiDetails();
        renderToppings();
    });
</script>
</body>
</html>